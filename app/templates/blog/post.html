{% extends "base.html" %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="blog-detail-container">
    <h2>{{ post.title }}</h2>
    
    <div class="post-meta">
        <span class="date">{{ post.created_at.strftime('%Y-%m-%d') }}</span>
        {% if post.category %}
            <span class="category">{{ post.category.name }}</span>
        {% endif %}
        {% if post.tags %}
            <div class="tags-container">
                {% for tag in post.tags %}
                    <span class="tag">{{ tag.name }}</span>
                {% endfor %}
            </div>
        {% endif %}
    </div>
    
    <div class="post-content">
        {{ post.content | safe }}
    </div>
    <div class="post-actions">
        <a href="{{ url_for('blog.edit', post_id=post.id) }}" class="edit-btn">수정</a>
        <button class="delete-btn" onclick="deletePost({{ post.id }})">삭제</button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function deletePost(postId) {
        if (confirm('정말로 이 글을 삭제하시겠습니까?')) {
            fetch(`/blog/posts/${postId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    window.location.href = "{{ url_for('blog.index') }}";
                } else {
                    alert(data.message || '삭제에 실패했습니다.');
                }
            })
            .catch(error => {
                console.error('오류:', error);
                alert('서버 통신 중 오류가 발생했습니다.');
            });
        }
    }
</script>
{% endblock %}